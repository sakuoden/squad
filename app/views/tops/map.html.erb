<script>
	$(document).ready(function(){
		$('.tops_top_flash_massage').fadeOut(8000);


  var areas = [
		{code : 1, name: "北海道", color: "#7f7eda", hoverColor: "#b3b2ee", prefectures: [1]},
		{code : 2, name: "青森", color: "#759ef4", hoverColor: "#98b9ff", prefectures: [2]},
		{code : 3, name: "岩手", color: "#759ef4", hoverColor: "#98b9ff", prefectures: [3]},
		{code : 4, name: "宮城", color: "#759ef4", hoverColor: "#98b9ff", prefectures: [4]},
		{code : 5, name: "秋田", color: "#759ef4", hoverColor: "#98b9ff", prefectures: [5]},
		{code : 6, name: "山形", color: "#759ef4", hoverColor: "#98b9ff", prefectures: [6]},
		{code : 7, name: "福島", color: "#759ef4", hoverColor: "#98b9ff", prefectures: [7]},
		{code : 8, name: "茨城", color: "#7ecfea", hoverColor: "#b7e5f4", prefectures: [8]},
		{code : 9, name: "栃木", color: "#7ecfea", hoverColor: "#b7e5f4", prefectures: [9]},
		{code : 10, name: "群馬", color: "#7ecfea", hoverColor: "#b7e5f4", prefectures: [10]},
		{code : 11, name: "埼玉", color: "#7ecfea", hoverColor: "#b7e5f4", prefectures: [11]},
		{code : 12, name: "千葉", color: "#7ecfea", hoverColor: "#b7e5f4", prefectures: [12]},
		{code : 13, name: "東京", color: "#7ecfea", hoverColor: "#b7e5f4", prefectures: [13]},
		{code : 14, name: "神奈川", color: "#7ecfea", hoverColor: "#b7e5f4", prefectures: [14]},
		{code : 15, name: "新潟", color: "#7cdc92", hoverColor: "#aceebb", prefectures: [15]},
		{code : 16, name: "富山", color: "#7cdc92", hoverColor: "#aceebb", prefectures: [16]},
		{code : 17, name: "石川", color: "#7cdc92", hoverColor: "#aceebb", prefectures: [17]},
		{code : 18, name: "福井", color: "#7cdc92", hoverColor: "#aceebb", prefectures: [18]},
		{code : 19, name: "山梨", color: "#7cdc92", hoverColor: "#aceebb", prefectures: [19]},
		{code : 20, name: "長野", color: "#7cdc92", hoverColor: "#aceebb", prefectures: [20]},
		{code : 21, name: "岐阜", color: "#7cdc92", hoverColor: "#aceebb", prefectures: [21]},
		{code : 22, name: "静岡", color: "#7cdc92", hoverColor: "#aceebb", prefectures: [22]},
		{code : 23, name: "愛知", color: "#7cdc92", hoverColor: "#aceebb", prefectures: [23]},
		{code : 24, name: "三重", color: "#ffe966", hoverColor: "#fff19c", prefectures: [24]},
		{code : 25, name: "滋賀", color: "#ffe966", hoverColor: "#fff19c", prefectures: [25]},
		{code : 26, name: "京都", color: "#ffe966", hoverColor: "#fff19c", prefectures: [26]},
		{code : 27, name: "大阪", color: "#ffe966", hoverColor: "#fff19c", prefectures: [27]},
		{code : 28, name: "兵庫", color: "#ffe966", hoverColor: "#fff19c", prefectures: [28]},
		{code : 29, name: "奈良", color: "#ffe966", hoverColor: "#fff19c", prefectures: [29]},
		{code : 30, name: "和歌山", color: "#ffe966", hoverColor: "#fff19c", prefectures: [30]},
		{code : 31, name: "鳥取", color: "#ffcc66", hoverColor: "#ffe0a3", prefectures: [31]},
		{code : 32, name: "島根", color: "#ffcc66", hoverColor: "#ffe0a3", prefectures: [32]},
		{code : 33, name: "岡山", color: "#ffcc66", hoverColor: "#ffe0a3", prefectures: [33]},
		{code : 34, name: "広島", color: "#ffcc66", hoverColor: "#ffe0a3", prefectures: [34]},
		{code : 35, name: "山口", color: "#ffcc66", hoverColor: "#ffe0a3", prefectures: [35]},
		{code : 36, name: "徳島", color: "#fb9466", hoverColor: "#ffbb9c", prefectures: [36]},
		{code : 37, name: "香川", color: "#fb9466", hoverColor: "#ffbb9c", prefectures: [37]},
		{code : 38, name: "愛媛", color: "#fb9466", hoverColor: "#ffbb9c", prefectures: [38]},
		{code : 39, name: "高知", color: "#fb9466", hoverColor: "#ffbb9c", prefectures: [39]},
		{code : 40, name: "福岡", color: "#ff9999", hoverColor: "#ffbdbd", prefectures: [40]},
		{code : 41, name: "佐賀", color: "#ff9999", hoverColor: "#ffbdbd", prefectures: [41]},
		{code : 42, name: "長崎", color: "#ff9999", hoverColor: "#ffbdbd", prefectures: [42]},
		{code : 43, name: "熊本", color: "#ff9999", hoverColor: "#ffbdbd", prefectures: [43]},
		{code : 44, name: "大分", color: "#ff9999", hoverColor: "#ffbdbd", prefectures: [44]},
		{code : 45, name: "宮崎", color: "#ff9999", hoverColor: "#ffbdbd", prefectures: [45]},
		{code : 46, name: "鹿児島", color: "#ff9999", hoverColor: "#ffbdbd", prefectures: [46]},
		{code : 47, name: "沖縄", color: "#eb98ff", hoverColor: "#f5c9ff", prefectures: [47]},
    ];

    // リンクする場合
    // var placelinks = {
    // 	20:"/teams/nagano"
    // };



		$("#map-container").japanMap(
			{
				areas  : areas, //上で設定したエリアの情報
				selection : "prefecture", //選ぶことができる範囲(県→prefecture、エリア→area)
				borderLineWidth: 0.25, //線の幅
				drawsBoxLine : false, //canvasを線で囲む場合はtrue
				movesIslands : true, //南西諸島を左上に移動させるときはtrue、移動させないときはfalse
				showsAreaName : true, //エリア名を表示しない場合はfalse
				width: 800, //canvasのwidth。別途heightも指定可。
				backgroundColor: "#e6ecf0", //canvasの背景色
				font : "MS Mincho", //地図に表示する文字のフォント
				fontSize : 12, //地図に表示する文字のサイズ
				fontColor : "areaColor", //地図に表示する文字の色。"areaColor"でエリアの色に合わせる
				fontShadowColor : "black", //地図に表示する文字の影の色

				onSelect : function(data){
					var id = data.area.code;
					$('#team_' + id).fadeIn();
					$('.top_map_all_modal').fadeIn();
					$('.top_map_modal_title').text(`${data.name}のチーム一覧`);


					// リンクする場合
					// location.href = placelinks[data.area.code];
            	}
			}
		);

		$('.top_map_all_modal').click(function(){
			$('.top_map_all_modal').fadeOut();
			$('.top_map_modal').fadeOut();
		});

		$('.fa-window-close').click(function(){
			$('.top_map_all_modal').fadeOut();
			$('.top_map_modal').fadeOut();
		});



	});


</script>





<% if flash[:notice] %>
	<div class="tops_top_flash_massage">
		<%= flash[:notice] %>
	</div>
<% end %>

<div class="top_map_all_modal"></div>

<div id="map-container" class="top_map_position"></div>

<% areas = [*1..47] %>
<% areas.each do |area| %>

<!-- モーダル画面 -->
	<div class="top_map_modal" id="team_<%=area%>">
		<div class="top_map_modal_close_position">
			<i class="fas fa-window-close"></i>
		</div>

		<!-- モーダル部分のタイトル -->
		<div class="top_map_modal_title">
		</div>
		<!-- モーダル部分のタイトルfin -->

		<% @teams.where(place: area).each do |team| %>

			<%= link_to team_path(team.id), class:"tops_map_modal_link" do %>

				<!-- モーダル画面のチーム1つずつの箱 -->
				<div class="top_map_modal_box_a_team">
					<table>
						<tr>
							<td><%= attachment_image_tag team, :team_image, :fill, 100, 100, fallback:"no_image.jpg", class:"top_map_modal_box_a_team_image" %>
							</td>
							<td><%= team.team_name %>
							</td>
							<td>メンバー　<%= team.members.count %>人
							</td>
							<td>フォロワー　<%= team.follows.count %>人
							</td>
						</tr>
					</table>

				</div>
				<!-- モーダル画面のチーム1つずつの箱fin -->

			<% end %>
			<!-- link_toのend -->

		<% end %>
		<!-- @teams.where.eachのend -->
		<div class="top_map_modal_box_last_border"></div>

	</div>
<!-- モーダル画面fin -->

<% end %>
<!-- areas.eachのend -->





















